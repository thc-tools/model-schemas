{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "http://github.com/thc-tools/schemas/common-schema.json",
    "title": "Opiniated object model schema",
    "description": "This schema describes a model-driven designed object model",
    "default": null,
    "definitions": {
        "entity": {
            "type": "object",
            "properties": {
                "guid":{
                    "$ref":"#/definitions/guid"
                },
                "name": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                }
            },
            "required":[
                "guid",
                "name",
                "description"
            ]
        },
        "field": {
            "type": "object",
            "properties": {
                "guid":{
                    "$ref":"#/definitions/guid"
                },
                "name": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                },
                "data-definition": {
                     "$ref": "#/definitions/guid"
                }
            },
            "required":[
                "guid",
                "name",
                "description",
                "data-definition"   
            ]
        },
        "data-definition": {
            "type": "object",
            "properties": {
                "guid":{
                    "$ref":"#/definitions/guid"
                },
                "name": {
                    "type": "string",
                    "pattern": "^DO_[A-Z0-9]+$"
                },
                "description": {
                    "type": "string"
                },
                "sqlType": {
                    "type": "string"
                },
                "dataType": {
                    "type": "string"
                },
                "precision": {
                    "type": "integer"
                },
                "scale": {
                    "type": "integer"
                },
                "length": {
                    "type": "integer"
                }
            },
            "required": [
                "guid",
                "name",
                "description",
                "sqlType",
                "dataType"
            ]
        },
        
        "condition":{
            "left":{
                "oneOf":[
                    {"$ref":"#/definitions/guid"},
                    {"$ref":"#/definitions/condition"},
                    {"type":["string", "number", "boolean"]}
                ]
            },
            "operator":{
                "enum": [">","<", "=","<=", ">=", "AND", "OR", "IS", "NOT"]
            },
            "right":{
                "oneOf":[
                    {"$ref":"#/definitions/guid"},
                    {"$ref":"#/definitions/conditions"},
                    {"type":["string", "number", "boolean"]}
                ]
            }
        },
        "guid":{
            "oneOf":[
                {"type": "string",
                 "pattern":"[0-9a-f]{32}$"},
                {"type":["string", "number"]}
            ]
        }
    }
}